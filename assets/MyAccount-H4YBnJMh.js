import{u as P,r as l,j as e,b as u,d as p,k as h,h as w}from"./index-BxpQZju1.js";import{Q as j,B as d}from"./ReactToastify-BmBIF6v2.js";const N=()=>{const{user:o}=P(),[r,m]=l.useState({firstname:"",surname:"",username:"",address:"",email:"",phoneNumber:""}),[n,f]=l.useState({oldPassword:"",newPassword:"",confirmNewPassword:""});l.useEffect(()=>{(async()=>{if(o)try{console.log("Fetching user info for UID:",o.uid);const s=u(p,"Users",o.uid),t=await h(s);t.exists()?(console.log("Fetched user info:",t.data()),m(t.data())):console.log("No such document!")}catch(s){console.error("Error fetching user info:",s),d.error("Failed to fetch user information.")}})()},[o]);const c=a=>{const{name:s,value:t}=a.target;m({...r,[s]:t})},i=a=>{f({...n,[a.target.name]:a.target.value})},g=async a=>{if(a.preventDefault(),o)try{console.log("Updating user info for UID:",o.uid);const s=u(p,"Users",o.uid);await w(s,r),d.success("User info updated successfully"),console.log("User info updated:",r),navigate(0)}catch(s){console.error("Error updating user info:",s),d.error("Failed to update user information.")}},x=async a=>{if(a.preventDefault(),n.newPassword!==n.confirmNewPassword){console.log("New passwords do not match!"),d.error("New passwords do not match!");return}if(o)try{console.log("Updating password for UID:",o.uid);const s=u(p,"Users",o.uid),t=await h(s);t.exists()&&(t.data().password===n.oldPassword?(await w(s,{password:n.newPassword}),d.success("Password updated successfully"),console.log("Password updated successfully"),navigate(0)):(console.log("Old password is incorrect"),d.error("Old password is incorrect")))}catch(s){console.error("Error updating password:",s),d.error("Failed to update password.")}};return e.jsxs("div",{className:"account-container",children:[e.jsxs("h1",{children:["My Account: ",r.username]}),e.jsxs("div",{className:"user-info-container",children:[e.jsx("h2",{children:"Personal Information"}),e.jsxs("form",{onSubmit:g,children:[e.jsx("input",{type:"text",name:"firstname",value:r.firstname,onChange:c,placeholder:"First name"}),e.jsx("input",{type:"text",name:"surname",value:r.surname,onChange:c,placeholder:"Surname"}),e.jsx("input",{type:"text",name:"address",value:r.address,onChange:c,placeholder:"Address"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:c,placeholder:"Email"}),e.jsx("input",{type:"text",name:"phoneNumber",value:r.phoneNumber,onChange:c,placeholder:"Phone number"}),e.jsx("button",{type:"submit",className:"save-btn",children:"Save Changes"})]})]}),e.jsxs("div",{className:"password-container",children:[e.jsx("h2",{children:"Password Settings"}),e.jsxs("form",{onSubmit:x,children:[e.jsx("input",{type:"password",name:"oldPassword",value:n.oldPassword,onChange:i,placeholder:"Old password"}),e.jsx("input",{type:"password",name:"newPassword",value:n.newPassword,onChange:i,placeholder:"New password"}),e.jsx("input",{type:"password",name:"confirmNewPassword",value:n.confirmNewPassword,onChange:i,placeholder:"Confirm new password"}),e.jsx("button",{type:"submit",className:"change-password-btn",children:"Change Password"})]})]}),e.jsx(j,{})]})};export{N as default};
