import{u as P,r as l,j as s,b as u,d as p,k as h,h as w}from"./index-B3Gr2Rn1.js";import{Q as j,B as d}from"./ReactToastify-BAxsrlg6.js";const N=()=>{const{user:o}=P(),[r,m]=l.useState({firstname:"",surname:"",username:"",address:"",email:"",phoneNumber:""}),[n,f]=l.useState({oldPassword:"",newPassword:"",confirmNewPassword:""});l.useEffect(()=>{(async()=>{if(o)try{console.log("Fetching user info for UID:",o.uid);const e=u(p,"Users",o.uid),t=await h(e);t.exists()?(console.log("Fetched user info:",t.data()),m(t.data())):console.log("No such document!")}catch(e){console.error("Error fetching user info:",e),d.error("Failed to fetch user information.")}})()},[o]);const c=a=>{const{name:e,value:t}=a.target;m({...r,[e]:t})},i=a=>{f({...n,[a.target.name]:a.target.value})},g=async a=>{if(a.preventDefault(),o)try{console.log("Updating user info for UID:",o.uid);const e=u(p,"Users",o.uid);await w(e,r),d.success("User info updated successfully"),console.log("User info updated:",r)}catch(e){console.error("Error updating user info:",e),d.error("Failed to update user information.")}},x=async a=>{if(a.preventDefault(),n.newPassword!==n.confirmNewPassword){console.log("New passwords do not match!"),d.error("New passwords do not match!");return}if(o)try{console.log("Updating password for UID:",o.uid);const e=u(p,"Users",o.uid),t=await h(e);t.exists()&&(t.data().password===n.oldPassword?(await w(e,{password:n.newPassword}),d.success("Password updated successfully"),console.log("Password updated successfully")):(console.log("Old password is incorrect"),d.error("Old password is incorrect")))}catch(e){console.error("Error updating password:",e),d.error("Failed to update password.")}};return s.jsxs("div",{className:"account-container",children:[s.jsxs("h1",{children:["My Account: ",r.username]}),s.jsxs("div",{className:"user-info-container",children:[s.jsx("h2",{children:"Personal Information"}),s.jsxs("form",{onSubmit:g,children:[s.jsx("input",{type:"text",name:"firstname",value:r.firstname,onChange:c,placeholder:"First name"}),s.jsx("input",{type:"text",name:"surname",value:r.surname,onChange:c,placeholder:"Surname"}),s.jsx("input",{type:"text",name:"address",value:r.address,onChange:c,placeholder:"Address"}),s.jsx("input",{type:"email",name:"email",value:r.email,onChange:c,placeholder:"Email"}),s.jsx("input",{type:"text",name:"phoneNumber",value:r.phoneNumber,onChange:c,placeholder:"Phone number"}),s.jsx("button",{type:"submit",className:"save-btn",children:"Save Changes"})]})]}),s.jsxs("div",{className:"password-container",children:[s.jsx("h2",{children:"Password Settings"}),s.jsxs("form",{onSubmit:x,children:[s.jsx("input",{type:"password",name:"oldPassword",value:n.oldPassword,onChange:i,placeholder:"Old password"}),s.jsx("input",{type:"password",name:"newPassword",value:n.newPassword,onChange:i,placeholder:"New password"}),s.jsx("input",{type:"password",name:"confirmNewPassword",value:n.confirmNewPassword,onChange:i,placeholder:"Confirm new password"}),s.jsx("button",{type:"submit",className:"change-password-btn",children:"Change Password"})]})]}),s.jsx(j,{})]})};export{N as default};
