import{r,u as D,e as S,j as a,c as h,q as m,w as n,g as E,b as f,d as i,h as q,i as N,a as A}from"./index-9z2HV39b.js";import{C as M,A as I}from"./Home1-Dv3Fp73o.js";const k=()=>{const[x,g]=r.useState([]),[w,d]=r.useState(!1),[j,u]=r.useState(null),{user:s}=D(),{searchTerm:c}=S(),l=async()=>{if(console.log("Fetching products for user:",s==null?void 0:s.uid),s&&s.uid){const e=h(i,"Products");let o=m(e,n("uid","==",s.uid));if(c){const t=c.toLowerCase();console.log("Searching for products with name containing:",c),o=m(e,n("uid","==",s.uid),n("product_name",">=",t),n("product_name","<=",t+"ï£¿"))}const p=(await E(o)).docs.map(t=>({...t.data(),id:t.id}));console.log("Products found:",p),g(p)}else console.log("No user or user UID found")};r.useEffect(()=>{l()},[s,c]);const y=()=>{u({product_name:"",price:"",product_detail:"",defect_exp_date:"",quantity:0,imageUrl:"",uid:s.uid}),d(!0)},C=e=>{u(e),d(!0)},P=async e=>{try{if(e.id){const o=f(i,"Products",e.id);await q(o,e)}else{const o=h(i,"Products");await N(o,e)}l(),d(!1)}catch(o){console.error("Error saving product:",o),alert("Product added/updated successfully!")}},_=async e=>{try{await A(f(i,"Products",e)),l()}catch(o){console.error("Error deleting product:",o)}},v=()=>d(!1);return a.jsxs("div",{className:"home1",children:[x.map(e=>a.jsx(M,{id:e.id,name:e.product_name,expired:e.defect_exp_date,price:e.price,quantity:e.quantity,onClick:()=>C(e),onDelete:_},e.id)),a.jsxs("div",{className:"card1 add-new-product",onClick:y,children:[a.jsx("div",{className:"card1-image add-new-image",children:a.jsx("span",{children:"+"})}),a.jsx("div",{className:"card1-details",children:a.jsx("div",{children:"Add New Product"})})]}),w&&a.jsx(I,{onSave:P,onClose:v,initialData:j})]})};export{k as default};
