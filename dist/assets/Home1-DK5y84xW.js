import{r,u as v,e as y,j as a,c as m,q as f,w as n,g as S,d as i}from"./index-KnTpx8DV.js";import{C as q,A as E}from"./Home1-B4wRO1RJ.js";const M=()=>{const[h,x]=r.useState([]),[g,d]=r.useState(!1),[w,l]=r.useState(null),{user:s}=v(),{searchTerm:c}=y(),u=async()=>{if(console.log("Fetching products for user:",s==null?void 0:s.uid),s&&s.uid){const e=m(i,"Products");let o=f(e,n("uid","==",s.uid));if(c){const t=c.toLowerCase();console.log("Searching for products with name containing:",c),o=f(e,n("uid","==",s.uid),n("product_name",">=",t),n("product_name","<=",t+"ï£¿"))}const p=(await S(o)).docs.map(t=>({...t.data(),id:t.id}));console.log("Products found:",p),x(p)}else console.log("No user or user UID found")};r.useEffect(()=>{u()},[s,c]);const j=()=>{l({product_name:"",price:"",product_detail:"",defect_exp_date:"",quantity:0,imageUrl:"",uid:s.uid}),d(!0)},C=e=>{l(e),d(!0)},P=async e=>{try{if(e.id){const o=doc(i,"Products",e.id);await updateDoc(o,e)}else{const o=m(i,"Products");await addDoc(o,e)}u(),d(!1)}catch(o){console.error("Error saving product:",o),alert("Product added/updated successfully!")}},_=()=>d(!1);return a.jsxs("div",{className:"home",children:[h.map(e=>a.jsx(q,{id:e.id,name:e.product_name,expired:e.defect_exp_date,price:e.price,quantity:e.quantity,onClick:()=>C(e)},e.id)),a.jsxs("div",{className:"card1 add-new-product",onClick:j,children:[a.jsx("div",{className:"card1-image add-new-image",children:a.jsx("span",{children:"+"})}),a.jsx("div",{className:"card1-details",children:a.jsx("div",{children:"Add New Product"})})]}),g&&a.jsx(E,{onSave:P,onClose:_,initialData:w})]})};export{M as default};
